
H = zeros(9,9);
s = zeros(9,1);

% Matriz representada como na saída esperada do programa para o ex2.sp
% Ordem das variáveis no exemplo e resposta esperada:
%
% V(node_A)    =  2.5000
% V(node_B)    =  7.5000
% V(node_C)    = 18.0000
% V(node_D)    =  3.0000
% V(node_E)    = -6.0000
% V(node_F)    =  9.0000
% I(V_Vbottom) = -1.5000
% I(V_Vright)  =  1.0000
% I(E_Eright)  =  1.0000

H(1,1) = 3.000000e-01;
H(1,2) = -1.000000e-01;
H(1,3) = 0.000000e+00;
H(1,4) = 0.000000e+00;
H(1,5) = 0.000000e+00;
H(1,6) = 0.000000e+00;
H(1,7) = 0.000000e+00;
H(1,8) = 0.000000e+00;
H(1,9) = 0.000000e+00;
H(2,1) = -1.000000e-01;
H(2,2) = 4.333333e-01;
H(2,3) = -3.333333e-01;
H(2,4) = 0.000000e+00;
H(2,5) = 0.000000e+00;
H(2,6) = 0.000000e+00;
H(2,7) = 0.000000e+00;
H(2,8) = 0.000000e+00;
H(2,9) = 0.000000e+00;
H(3,1) = 0.000000e+00;
H(3,2) = -3.333333e-01;
H(3,3) = 3.333333e-01;
H(3,4) = 0.000000e+00;
H(3,5) = 0.000000e+00;
H(3,6) = 0.000000e+00;
H(3,7) = 1.000000e+00;
H(3,8) = 0.000000e+00;
H(3,9) = 0.000000e+00;
H(4,1) = 0.000000e+00;
H(4,2) = 0.000000e+00;
H(4,3) = 0.000000e+00;
H(4,4) = 0.000000e+00;
H(4,5) = 0.000000e+00;
H(4,6) = 0.000000e+00;
H(4,7) = 0.000000e+00;
H(4,8) = 1.000000e+00;
H(4,9) = 0.000000e+00;
H(5,1) = 0.000000e+00;
H(5,2) = 0.000000e+00;
H(5,3) = 0.000000e+00;
H(5,4) = 0.000000e+00;
H(5,5) = 0.000000e+00;
H(5,6) = 0.000000e+00;
H(5,7) = 0.000000e+00;
H(5,8) = -1.000000e+00;
H(5,9) = 1.000000e+00;
H(6,1) = 0.000000e+00;
H(6,2) = 0.000000e+00;
H(6,3) = 0.000000e+00;
H(6,4) = 0.000000e+00;
H(6,5) = 0.000000e+00;
H(6,6) = 1.111111e-01;
H(6,7) = 0.000000e+00;
H(6,8) = 0.000000e+00;
H(6,9) = -1.000000e+00;
H(7,1) = 0.000000e+00;
H(7,2) = 0.000000e+00;
H(7,3) = 1.000000e+00;
H(7,4) = 0.000000e+00;
H(7,5) = 0.000000e+00;
H(7,6) = 0.000000e+00;
H(7,7) = 0.000000e+00;
H(7,8) = 0.000000e+00;
H(7,9) = 0.000000e+00;
H(8,1) = 0.000000e+00;
H(8,2) = 0.000000e+00;
H(8,3) = 0.000000e+00;
H(8,4) = 1.000000e+00;
H(8,5) = -1.000000e+00;
H(8,6) = 0.000000e+00;
H(8,7) = 0.000000e+00;
H(8,8) = 0.000000e+00;
H(8,9) = 0.000000e+00;
H(9,1) = -3.000000e+00;
H(9,2) = 3.000000e+00;
H(9,3) = 0.000000e+00;
H(9,4) = 0.000000e+00;
H(9,5) = 1.000000e+00;
H(9,6) = -1.000000e+00;
H(9,7) = 0.000000e+00;
H(9,8) = 0.000000e+00;
H(9,9) = 0.000000e+00;
;
s(1) = 0.000000e+00;
s(2) = -3.000000e+00;
s(3) = 2.000000e+00;
s(4) = 1.000000e+00;
s(5) = 0.000000e+00;
s(6) = 0.000000e+00;
s(7) = 1.800000e+01;
s(8) = 9.000000e+00; % s(8) e s(9) estavam invertidos na versão anterior
s(9) = 0.000000e+00;

fprintf('Efetuando a decomposição LU...\n\n');
[LU,P] = LU_fase1(H);
fprintf('Efetuando a substituição progressiva...\n\n');
y  = LU_fase2(LU,s,P);
fprintf('Efetuando a substituição regressiva...\n\n');
x = LU_fase3(LU,y,P);


